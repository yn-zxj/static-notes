import{j as I,d as Z,k as ee,l as U,u as ae,m as te,t as se,n as le,p as D,q as S,v as re,x as G,h as t,y as T,z as $,R as O,A as ne,B as ie,C as ce,D as ue,E as de,G as oe,s as ve,b as he,O as pe,H as be,I as me,P as ye,J as ke,K as ge,L}from"./app-fpN15tNc.js";const fe=["/","/backend/","/frontend/","/guide/","/interview/","/nav/","/others/pve.html","/snippet/Git.html","/snippet/JavaScript.html","/snippet/","/backend/arthas/","/backend/arthas/command.html","/backend/arthas/guide.html","/backend/arthas/introduce.html","/backend/database/","/backend/docker/","/backend/docker/basic.html","/backend/docker/data_volume.html","/backend/docker/dockerfile.html","/backend/docker/image.html","/backend/java/","/backend/java/java-reflect.html","/backend/java/lambda.html","/backend/java/syntactic-sugar.html","/backend/redis/","/backend/redis/data_types.html","/backend/redis/install_and_config.html","/frontend/typescript/","/frontend/typescript/base_type.html","/frontend/typescript/compilation_options.html","/frontend/typescript/intro.html","/frontend/typescript/object_oriented.html","/frontend/typescript/practice.html","/frontend/typescript/webpack_packing.html","/frontend/vue/","/frontend/vue/base_vue.html","/frontend/vue/component_programming.html","/frontend/vue/intro.html","/frontend/vue/vue_cli.html","/interview/java/java-database.html","/interview/java/java-foundation.html","/interview/java/java-frame.html","/interview/java/java-tech_points.html","/interview/java/java-web.html","/backend/database/advanced/","/backend/database/advanced/data_structure_of_index.html","/backend/database/advanced/dir_of_mysql.html","/backend/database/advanced/innodb_data_strore_structure.html","/backend/database/advanced/install_and_uninstall.html","/backend/database/advanced/logical_architecture.html","/backend/database/advanced/storage_engine.html","/backend/database/advanced/user_and_privilege.html","/backend/database/base/","/backend/database/base/aggregate_function.html","/backend/database/base/constraint.html","/backend/database/base/create_management_table.html","/backend/database/base/data_processing.html","/backend/database/base/data_query.html","/backend/database/base/data_type.html","/backend/database/base/database_overview.html","/backend/database/base/environment_building.html","/backend/database/base/multi_table_query.html","/backend/database/base/new_features.html","/backend/database/base/one_line_function.html","/backend/database/base/operator.html","/backend/database/base/procedure_and_function.html","/backend/database/base/sorting_paging.html","/backend/database/base/subquery.html","/backend/database/base/trigger.html","/backend/database/base/variable_flow_cursor.html","/backend/database/base/view.html","/404.html","/others/","/interview/java/","/category/","/category/%E5%85%B6%E5%AE%83/","/category/git/","/category/%E5%89%8D%E7%AB%AF/","/category/%E5%90%8E%E7%AB%AF/","/category/%E6%95%B0%E6%8D%AE%E5%BA%93/","/tag/","/tag/redis/","/tag/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5/","/tag/git/","/tag/javascript/","/tag/arthas/","/tag/docker/","/tag/java/","/tag/typescript/","/tag/vue/","/tag/%E9%9D%A2%E8%AF%95/","/tag/mysql/","/article/","/star/","/timeline/"],_e="SEARCH_PRO_QUERY_HISTORY",p=I(_e,[]),we=()=>{const{queryHistoryCount:s}=L,l=s>0;return{enabled:l,queryHistory:p,addQueryHistory:r=>{l&&(p.value.length<s?p.value=Array.from(new Set([r,...p.value])):p.value=Array.from(new Set([r,...p.value.slice(0,s-1)])))},removeQueryHistory:r=>{p.value=[...p.value.slice(0,r),...p.value.slice(r+1)]}}},B=s=>fe[s.id]+("anchor"in s?`#${s.anchor}`:""),Ee="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:C}=L,b=I(Ee,[]),He=()=>{const s=C>0;return{enabled:s,resultHistory:b,addResultHistory:l=>{if(s){const r={link:B(l),display:l.display};"header"in l&&(r.header=l.header),b.value.length<C?b.value=[r,...b.value]:b.value=[r,...b.value.slice(0,C-1)]}},removeResultHistory:l=>{b.value=[...b.value.slice(0,l),...b.value.slice(l+1)]}}},Re=s=>{const l=de(),r=U(),j=oe(),i=D(!1),y=ve([]);return he(()=>{const{search:_,terminate:m}=pe(),w=()=>{y.value=[],i.value=!1},k=ge(v=>{i.value=!0,v?_(v,r.value,l.value).then(h=>{var E,g;return((g=(E=l.value).searchFilter)==null?void 0:g.call(E,h,v,r.value,j.value))??h}).then(h=>{y.value=h,i.value=!1}).catch(h=>{console.error(h),w()}):w()},L.searchDelay);G([s,r],()=>k(s.value),{immediate:!0}),be(()=>{m()})}),{searching:i,results:y}};var Ae=Z({name:"SearchResult",props:{query:{type:String,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:l}){const r=ee(),j=U(),i=ae(te),{enabled:y,addQueryHistory:_,queryHistory:m,removeQueryHistory:w}=we(),{enabled:k,resultHistory:v,addResultHistory:h,removeResultHistory:E}=He(),g=y||k,A=se(s,"query"),{results:f,searching:J}=Re(A),n=le({isQuery:!0,index:0}),d=D(0),o=D(0),F=S(()=>g&&(m.value.length>0||v.value.length>0)),Q=S(()=>f.value.length>0),x=S(()=>f.value[d.value]||null),M=()=>{const{isQuery:e,index:a}=n;a===0?(n.isQuery=!e,n.index=e?v.value.length-1:m.value.length-1):n.index=a-1},Y=()=>{const{isQuery:e,index:a}=n;a===(e?m.value.length-1:v.value.length-1)?(n.isQuery=!e,n.index=0):n.index=a+1},z=()=>{d.value=d.value>0?d.value-1:f.value.length-1,o.value=x.value.contents.length-1},K=()=>{d.value=d.value<f.value.length-1?d.value+1:0,o.value=0},V=()=>{o.value<x.value.contents.length-1?o.value+=1:K()},N=()=>{o.value>0?o.value-=1:z()},q=e=>e.map(a=>me(a)?a:t(a[0],a[1])),W=e=>{if(e.type==="customField"){const a=ye[e.index]||"$content",[c,R=""]=ke(a)?a[j.value].split("$content"):a.split("$content");return e.display.map(u=>t("div",q([c,...u,R])))}return e.display.map(a=>t("div",q(a)))},H=()=>{d.value=0,o.value=0,l("updateQuery",""),l("close")};return re("keydown",e=>{if(s.isFocusing){if(Q.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const a=x.value.contents[o.value];_(s.query),h(a),r.push(B(a)),H()}}else if(k){if(e.key==="ArrowUp")M();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:a}=n;n.isQuery?(l("updateQuery",m.value[a]),e.preventDefault()):(r.push(v.value[a].link),H())}}}}),G([d,o],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:A.value?!Q.value:!F.value}],id:"search-pro-results"},A.value===""?g?F.value?[y?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},i.value.queryHistory),m.value.map((e,a)=>t("div",{class:["search-pro-result-item",{active:n.isQuery&&n.index===a}],onClick:()=>{l("updateQuery",e)}},[t(T,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:c=>{c.preventDefault(),c.stopPropagation(),w(a)}})]))])):null,k?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},i.value.resultHistory),v.value.map((e,a)=>t(O,{to:e.link,class:["search-pro-result-item",{active:!n.isQuery&&n.index===a}],onClick:()=>{H()}},()=>[t(T,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(c=>q(c)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:c=>{c.preventDefault(),c.stopPropagation(),E(a)}})]))])):null]:i.value.emptyHistory:i.value.emptyResult:J.value?t(ne,{hint:i.value.searching}):Q.value?t("ul",{class:"search-pro-result-list"},f.value.map(({title:e,contents:a},c)=>{const R=d.value===c;return t("li",{class:["search-pro-result-list-item",{active:R}]},[t("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),a.map((u,X)=>{const P=R&&o.value===X;return t(O,{to:B(u),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{_(s.query),h(u),H()}},()=>[u.type==="text"?null:t(u.type==="title"?ie:u.type==="heading"?ce:ue,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[u.type==="text"&&u.header?t("div",{class:"content-header"},u.header):null,t("div",W(u))])])})])})):i.value.emptyResult)}});export{Ae as default};
